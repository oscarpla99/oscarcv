// Traducciones completas para español e inglés
const i18n = {
  es: {
    // Navegación
    'nav.home': 'Inicio',
    'nav.about': 'Sobre mí',
    'nav.experience': 'Experiencia',
    'nav.services': 'Servicios',
    'nav.blog': 'Blog',
    'nav.contact': 'Contacto',
    
    // Hero
    'hero.title': 'Export Area Manager | Especialista en Ventas Internacionales',
    'hero.subtitle': 'Experiencia en +55 países • IA & Automatización • Pet Business',
    'hero.desc': 'Especialista en desarrollo de mercados internacionales con experiencia en +55 países y conocimiento avanzado en IA y automatización.',
    'hero.btn1': 'Ver experiencia',
    'hero.btn2': 'Contactar',
    
    // Sobre mí
    'about.title': 'Sobre mí',
    'about.intro': 'Como Export Area Manager especializado en ventas internacionales, he dedicado mi carrera profesional al desarrollo y expansión de mercados globales, acumulando experiencia directa en +55 países a lo largo del mundo.',
    'about.p1': 'Mi enfoque se centra en la integración de tecnologías avanzadas de Inteligencia Artificial y automatización en los procesos de exportación, lo que permite a las empresas optimizar sus operaciones internacionales y mantener una ventaja competitiva en el mercado global.',
    'about.p2': 'Con sede en Vilassar de Dalt, Catalunya, trabajo con empresas que buscan expandir su presencia internacional de manera estratégica y eficiente, aprovechando las oportunidades que ofrece la transformación digital del comercio internacional.',
    'about.countries': 'Países',
    'about.years': 'Años de experiencia',
    
    // Experiencia
    'exp.title': 'Experiencia Profesional',
    'exp.eam.title': 'Export Area Manager',
    'exp.eam.desc': 'Lidero la expansión internacional en +55 países, empleando estrategias comerciales avanzadas y desarrollando alianzas clave con socios globales. Responsable del diseño y ejecución de la estrategia de ventas internacional, gestión de equipos multiculturales y negociación de acuerdos comerciales de alto valor en Europa, América y Asia.',
    'exp.eam.a1': 'Incrementé las ventas globales en +32% durante dos años a través de la personalización de propuestas de valor y el fortalecimiento de relaciones con distribuidores internacionales.',
    'exp.eam.a2': 'Organicé y lideré la participación en ferias y eventos internacionales de referencia (Cosmoprof, Beautyworld...) posicionando la marca en mercados estratégicos.',
    'exp.eam.a3': 'Abrí y consolidé nuevos mercados en Asia, desarrollando relaciones comerciales duraderas con clientes clave y adaptando la oferta de productos a las necesidades locales.',
    'exp.eam.a4': 'Aporto experiencia consolidada en el pet business, colaborando con marcas y distribuidores de productos y servicios para mascotas a nivel global, lo que me permite comprender las particularidades y tendencias del sector de animales de compañía.',
    'exp.ea.title': 'Export Assistant',
    'exp.ea.desc': 'Apoyé todas las operaciones de exportación, desde la atención a clientes internacionales hasta la gestión de documentación aduanera y coordinación logística. Me especialicé en el estudio de regulaciones de mercados internacionales y la resolución eficaz de incidencias durante el ciclo de exportación.',
    'exp.ea.a1': 'Gestioné más de 120 expedientes de exportación a destinos exigentes con una tasa de éxito del 99%.',
    'exp.ea.a2': 'Colaboré en la formación del equipo en temas de normativas internacionales y estándares de calidad.',
    'exp.log.title': 'Operario de Logística',
    'exp.log.desc': 'Experiencia fundamental en operaciones logísticas y gestión de almacenes que estableció las bases para mi especialización en comercio internacional. Gestión integral de procesos de almacenaje, picking y preparación de pedidos para exportación.',
    
    // Servicios
    'services.title': 'Servicios',
    'services.s1.title': 'Consultoría Internacional',
    'services.s1.desc': 'Asesoramiento especializado para empresas que buscan expandirse internacionalmente',
    'services.s2.title': 'Estrategia de Mercado',
    'services.s2.desc': 'Estrategias personalizadas para penetrar en nuevos mercados globales',
    'services.s3.title': 'IA aplicada a Export',
    'services.s3.desc': 'Implementación de soluciones de inteligencia artificial para optimizar procesos de exportación',
    'services.s4.title': 'Análisis de Mercados',
    'services.s4.desc': 'Estudios detallados de viabilidad y potencial de mercados internacionales',
    
    // Blog
    'blog.title': 'Blog',
    
    // Traducciones de los blogs - NUEVOS
    'blog.1.title': 'Los Aranceles de Trump 2025: Impacto en las Exportaciones Españolas',
    'blog.1.excerpt': 'Análisis del impacto de las nuevas políticas arancelarias de la administración Trump en el comercio internacional español.',
    'blog.1.content': 'La nueva administración Trump ha implementado aranceles que van desde el 10% al 145% según el país de origen. Para España, esto significa un arancel del 15% para la mayoría de productos exportados a Estados Unidos. Este cambio representa un desafío significativo para nuestras exportaciones, especialmente en sectores como automóviles, productos químicos y maquinaria. Las empresas españolas deben adaptarse rápidamente a esta nueva realidad comercial, diversificando mercados y optimizando su competitividad mediante la implementación de tecnologías avanzadas y automatización de procesos.',
    
    'blog.2.title': 'IA y Automatización: El Futuro de las Exportaciones',
    'blog.2.excerpt': 'Cómo la inteligencia artificial está revolucionando los procesos de exportación y comercio internacional.',
    'blog.2.content': 'La inteligencia artificial está transformando radicalmente el comercio internacional. Las empresas que implementan soluciones de IA pueden reducir costos operativos hasta un 40-60% y mejorar la precisión en forecasting de demanda en un 23%. Desde la automatización de documentación aduanera hasta la optimización de rutas logísticas, la IA permite a las empresas exportadoras ser más competitivas y eficientes. En mi experiencia trabajando con +55 países, he visto cómo las empresas que adoptan estas tecnologías superan consistentemente a sus competidores tradicionales.',
    
    'blog.3.title': 'España Alcanza Record de €384 Mil Millones en Exportaciones 2024',
    'blog.3.excerpt': 'Las exportaciones españolas muestran resistencia pese al complejo contexto internacional.',
    'blog.3.content': 'España ha logrado su segundo mejor año histórico en exportaciones con €384.465 mil millones en 2024, representando un crecimiento del 2.7% en diciembre. Los sectores líderes incluyen bienes de capital (19.5%), alimentos y bebidas (17.5%), productos químicos (16.8%) y automoción (14.1%). El sector automovilístico destacó con un crecimiento del 20.6%. Esta robustez del sector exterior español demuestra la capacidad de adaptación de nuestras empresas, especialmente aquellas que han integrado tecnologías avanzadas y diversificado sus mercados internacionales.',
    
    'blog.4.title': 'Europa vs. Competitividad Global: El Desafío de 2025',
    'blog.4.excerpt': 'Análisis de la posición competitiva de Europa en el comercio mundial y las estrategias necesarias.',
    'blog.4.content': 'Europa enfrenta desafíos significativos en competitividad global, con China liderando con 30.2% de participación en manufactura versus 15% de la UE. Sin embargo, Europa mantiene ventajas en sectores de alta tecnología y servicios avanzados. La clave está en la integración del mercado único, la digitalización y la simplificación regulatoria. Como profesional con experiencia en mercados globales, veo oportunidades enormes para empresas europeas que adopten estrategias digitales y aprovechen las fortalezas del ecosistema industrial europeo.',
    
    'blog.5.title': 'Comercio Global Alcanza Record de $33 Billones en 2024',
    'blog.5.excerpt': 'El comercio mundial muestra resistencia pese a tensiones geopolíticas y desafíos económicos.',
    'blog.5.content': 'El comercio global alcanzó un récord de $33 billones en 2024, impulsado por un crecimiento del 7% en servicios y 2% en bienes. Asia lideró el crecimiento con importaciones del 5.6%, mientras que el comercio Sur-Sur creció un 5%. Esta expansión, pese a las tensiones comerciales, demuestra la resiliencia del sistema comercial global. Para exportadores españoles, esto representa oportunidades en mercados emergentes, especialmente en servicios digitales y productos de alta tecnología donde tenemos ventajas competitivas.',
    
    'blog.6.title': 'Automatización de Procesos de Export: Casos de Éxito',
    'blog.6.excerpt': 'Ejemplos prácticos de cómo la automatización mejora la eficiencia en operaciones de exportación.',
    'blog.6.content': 'La automatización en procesos de exportación no es futuro, es presente. He implementado sistemas que automatizan desde la clasificación arancelaria hasta el seguimiento de envíos, reduciendo tiempos de procesamiento en 65% y errores en documentación en 40%. Herramientas de IA para forecasting de demanda, optimización de rutas y gestión de riesgos están transformando cómo operamos. Las empresas que he asesorado han visto mejoras promedio del 30% en eficiencia operativa y reducción del 25% en costos logísticos.',
    
    'blog.7.title': 'Diversificación de Mercados: Estrategias Post-COVID',
    'blog.7.excerpt': 'La importancia de diversificar destinos de exportación en el nuevo contexto económico global.',
    'blog.7.content': 'La diversificación geográfica se ha vuelto crítica. Mi experiencia en +55 países me ha enseñado que las empresas resilientes son aquellas que no dependen de un solo mercado. ASEAN, América Latina y África emergente ofrecen oportunidades extraordinarias. La clave está en entender las particularidades culturales, regulatorias y comerciales de cada región. Las herramientas de IA me permiten analizar patrones de consumo y tendencias de mercado en tiempo real, facilitando la toma de decisiones estratégicas para la expansión internacional.',
    
    'blog.8.title': 'El Impacto de la Fragmentación Comercial Global',
    'blog.8.excerpt': 'Análisis de cómo la reconfiguración de cadenas globales afecta a las estrategias de exportación.',
    'blog.8.content': 'La fragmentación comercial está redefiniendo el mapa del comercio global. Los acuerdos bilaterales, como el reciente EU-US que establece aranceles del 15%, y la reconfiguración de cadenas de suministro crear nuevas dinámicas. Para exportadores españoles, esto significa oportunidades en nearshoring, especialmente en sectores donde tenemos ventajas comparativas. La automatización y la IA se vuelven herramientas esenciales para navegar esta complejidad creciente y mantener la competitividad en múltiples mercados simultáneamente.',
    
    // Contacto
    'contact.title': 'Contacto',
    'contact.info.title': '¿Necesitas expandir tu negocio internacionalmente?',
    'contact.info.desc': '¿Quieres implementar soluciones de IA en tus procesos de exportación? Contacta conmigo y exploremos las oportunidades juntos.',
    'contact.location.label': 'Ubicación:',
    'contact.location.value': 'Vilassar de Dalt, Catalunya, España',
    'contact.specialization.label': 'Especialización:',
    'contact.specialization.value': 'Export Area Manager, IA y Automatización',
    'contact.experience.label': 'Experiencia:',
    'contact.experience.value': '+55 países, Pet Business, Beauty & Care',
    'contact.form.name': 'Nombre*',
    'contact.form.email': 'Email*',
    'contact.form.company': 'Compañía',
    'contact.form.message': 'Mensaje*',
    'contact.form.btn': 'Enviar mensaje'
  },
  en: {
    // Navigation
    'nav.home': 'Home',
    'nav.about': 'About',
    'nav.experience': 'Experience',
    'nav.services': 'Services',
    'nav.blog': 'Blog',
    'nav.contact': 'Contact',
    
    // Hero
    'hero.title': 'Export Area Manager | International Sales Specialist',
    'hero.subtitle': 'Experience in 55+ countries • AI & Automation • Pet Business',
    'hero.desc': 'Specialist in international market development with experience in 55+ countries and advanced knowledge in AI and automation.',
    'hero.btn1': 'See experience',
    'hero.btn2': 'Contact',
    
    // About
    'about.title': 'About me',
    'about.intro': 'As an Export Area Manager specialized in international sales, I have dedicated my professional career to the development and expansion of global markets, accumulating direct experience in 55+ countries worldwide.',
    'about.p1': 'My approach focuses on the integration of advanced Artificial Intelligence technologies and automation in export processes, allowing companies to optimize their international operations and maintain a competitive advantage in the global market.',
    'about.p2': 'Based in Vilassar de Dalt, Catalonia, I work with companies seeking to expand their international presence strategically and efficiently, leveraging the opportunities offered by the digital transformation of international trade.',
    'about.countries': 'Countries',
    'about.years': 'Years of experience',
    
    // Experience
    'exp.title': 'Professional Experience',
    'exp.eam.title': 'Export Area Manager',
    'exp.eam.desc': 'I lead international expansion in 55+ countries, employing advanced commercial strategies and developing key alliances with global partners. Responsible for designing and executing international sales strategy, managing multicultural teams and negotiating high-value commercial agreements in Europe, America and Asia.',
    'exp.eam.a1': 'Increased global sales by 32% over two years through personalized value propositions and strengthening relationships with international distributors.',
    'exp.eam.a2': 'Organized and led participation in leading international trade shows (Cosmoprof, Beautyworld...) positioning the brand in strategic markets.',
    'exp.eam.a3': 'Opened and consolidated new markets in Asia, developing lasting commercial relationships with key clients and adapting product offerings to local needs.',
    'exp.eam.a4': 'I bring consolidated experience in the pet business, collaborating with brands and distributors of products and services for pets globally, which allows me to understand the particularities and trends of the pet sector.',
    'exp.ea.title': 'Export Assistant',
    'exp.ea.desc': 'I supported all export operations, from customer service to international clients to customs documentation management and logistics coordination. I specialized in studying international market regulations and efficiently resolving incidents during the export cycle.',
    'exp.ea.a1': 'Managed over 120 export files to demanding destinations with a 99% success rate.',
    'exp.ea.a2': 'Collaborated in team training on international regulations and quality standards.',
    'exp.log.title': 'Logistics Operator',
    'exp.log.desc': 'Fundamental experience in logistics operations and warehouse management that established the foundation for my specialization in international trade. Comprehensive management of warehousing, picking and export order preparation processes.',
    
    // Services
    'services.title': 'Services',
    'services.s1.title': 'International Consulting',
    'services.s1.desc': 'Specialized advisory for companies seeking to expand internationally',
    'services.s2.title': 'Market Strategy',
    'services.s2.desc': 'Personalized strategies to penetrate new global markets',
    'services.s3.title': 'AI applied to Export',
    'services.s3.desc': 'Implementation of artificial intelligence solutions to optimize export processes',
    'services.s4.title': 'Market Analysis',
    'services.s4.desc': 'Detailed feasibility and potential studies of international markets',
    
    // Blog
    'blog.title': 'Blog',
    
    // Traducciones de los blogs en inglés - NUEVOS
    'blog.1.title': 'Trump 2025 Tariffs: Impact on Spanish Exports',
    'blog.1.excerpt': 'Analysis of the impact of new tariff policies from the Trump administration on Spanish international trade.',
    'blog.1.content': 'The new Trump administration has implemented tariffs ranging from 10% to 145% depending on the country of origin. For Spain, this means a 15% tariff for most products exported to the United States. This change represents a significant challenge for our exports, especially in sectors such as automobiles, chemicals and machinery. Spanish companies must quickly adapt to this new commercial reality, diversifying markets and optimizing their competitiveness through the implementation of advanced technologies and process automation.',
    
    'blog.2.title': 'AI and Automation: The Future of Exports',
    'blog.2.excerpt': 'How artificial intelligence is revolutionizing export processes and international trade.',
    'blog.2.content': 'Artificial intelligence is radically transforming international trade. Companies implementing AI solutions can reduce operational costs by up to 40-60% and improve demand forecasting accuracy by 23%. From automating customs documentation to optimizing logistics routes, AI enables export companies to be more competitive and efficient. In my experience working with 55+ countries, I have seen how companies that adopt these technologies consistently outperform their traditional competitors.',
    
    'blog.3.title': 'Spain Reaches Record €384 Billion in 2024 Exports',
    'blog.3.excerpt': 'Spanish exports show resilience despite the complex international context.',
    'blog.3.content': 'Spain has achieved its second-best historical year in exports with €384.465 billion in 2024, representing 2.7% growth in December. Leading sectors include capital goods (19.5%), food and beverages (17.5%), chemicals (16.8%) and automotive (14.1%). The automotive sector stood out with 20.6% growth. This robustness of the Spanish external sector demonstrates the adaptability of our companies, especially those that have integrated advanced technologies and diversified their international markets.',
    
    'blog.4.title': 'Europe vs. Global Competitiveness: The 2025 Challenge',
    'blog.4.excerpt': 'Analysis of Europe\'s competitive position in world trade and necessary strategies.',
    'blog.4.content': 'Europe faces significant challenges in global competitiveness, with China leading with 30.2% participation in manufacturing versus 15% of the EU. However, Europe maintains advantages in high-tech sectors and advanced services. The key lies in single market integration, digitalization and regulatory simplification. As a professional with experience in global markets, I see enormous opportunities for European companies that adopt digital strategies and leverage the strengths of the European industrial ecosystem.',
    
    'blog.5.title': 'Global Trade Reaches Record $33 Trillion in 2024',
    'blog.5.excerpt': 'World trade shows resilience despite geopolitical tensions and economic challenges.',
    'blog.5.content': 'Global trade reached a record $33 trillion in 2024, driven by 7% growth in services and 2% in goods. Asia led growth with 5.6% imports, while South-South trade grew 5%. This expansion, despite trade tensions, demonstrates the resilience of the global trading system. For Spanish exporters, this represents opportunities in emerging markets, especially in digital services and high-tech products where we have competitive advantages.',
    
    'blog.6.title': 'Export Process Automation: Success Stories',
    'blog.6.excerpt': 'Practical examples of how automation improves efficiency in export operations.',
    'blog.6.content': 'Automation in export processes is not future, it is present. I have implemented systems that automate from tariff classification to shipment tracking, reducing processing times by 65% and documentation errors by 40%. AI tools for demand forecasting, route optimization and risk management are transforming how we operate. The companies I have advised have seen average improvements of 30% in operational efficiency and 25% reduction in logistics costs.',
    
    'blog.7.title': 'Market Diversification: Post-COVID Strategies',
    'blog.7.excerpt': 'The importance of diversifying export destinations in the new global economic context.',
    'blog.7.content': 'Geographic diversification has become critical. My experience in 55+ countries has taught me that resilient companies are those that do not depend on a single market. ASEAN, Latin America and emerging Africa offer extraordinary opportunities. The key is understanding the cultural, regulatory and commercial particularities of each region. AI tools allow me to analyze consumption patterns and market trends in real time, facilitating strategic decision-making for international expansion.',
    
    'blog.8.title': 'The Impact of Global Trade Fragmentation',
    'blog.8.excerpt': 'Analysis of how global supply chain reconfiguration affects export strategies.',
    'blog.8.content': 'Trade fragmentation is redefining the global trade map. Bilateral agreements, such as the recent EU-US establishing 15% tariffs, and supply chain reconfiguration create new dynamics. For Spanish exporters, this means opportunities in nearshoring, especially in sectors where we have comparative advantages. Automation and AI become essential tools to navigate this growing complexity and maintain competitiveness in multiple markets simultaneously.',
    
    // Contact
    'contact.title': 'Contact',
    'contact.info.title': 'Need to expand your business internationally?',
    'contact.info.desc': 'Want to implement AI solutions in your export processes? Contact me and let\'s explore opportunities together.',
    'contact.location.label': 'Location:',
    'contact.location.value': 'Vilassar de Dalt, Catalonia, Spain',
    'contact.specialization.label': 'Specialization:',
    'contact.specialization.value': 'Export Area Manager, AI and Automation',
    'contact.experience.label': 'Experience:',
    'contact.experience.value': '55+ countries, Pet Business, Beauty & Care',
    'contact.form.name': 'Name*',
    'contact.form.email': 'Email*',
    'contact.form.company': 'Company',
    'contact.form.message': 'Message*',
    'contact.form.btn': 'Send message'
  }
};

let currentLang = 'es';

// Blog posts data - MODIFICADO para usar claves de traducción
const blogPosts = [
  {
    id: 1,
    titleKey: 'blog.1.title',
    excerptKey: 'blog.1.excerpt',
    contentKey: 'blog.1.content',
    date: "29 Jul 2025"
  },
  {
    id: 2,
    titleKey: 'blog.2.title',
    excerptKey: 'blog.2.excerpt',
    contentKey: 'blog.2.content',
    date: "25 Jul 2025"
  },
  {
    id: 3,
    titleKey: 'blog.3.title',
    excerptKey: 'blog.3.excerpt',
    contentKey: 'blog.3.content',
    date: "20 Jul 2025"
  },
  {
    id: 4,
    titleKey: 'blog.4.title',
    excerptKey: 'blog.4.excerpt',
    contentKey: 'blog.4.content',
    date: "15 Jul 2025"
  },
  {
    id: 5,
    titleKey: 'blog.5.title',
    excerptKey: 'blog.5.excerpt',
    contentKey: 'blog.5.content',
    date: "10 Jul 2025"
  },
  {
    id: 6,
    titleKey: 'blog.6.title',
    excerptKey: 'blog.6.excerpt',
    contentKey: 'blog.6.content',
    date: "05 Jul 2025"
  },
  {
    id: 7,
    titleKey: 'blog.7.title',
    excerptKey: 'blog.7.excerpt',
    contentKey: 'blog.7.content',
    date: "30 Jun 2025"
  },
  {
    id: 8,
    titleKey: 'blog.8.title',
    excerptKey: 'blog.8.excerpt',
    contentKey: 'blog.8.content',
    date: "25 Jun 2025"
  }
];

// Language toggle functionality
function initLangToggle() {
  const btn = document.getElementById('lang-toggle');
  if (!btn) return;
  
  btn.addEventListener('click', () => {
    currentLang = currentLang === 'es' ? 'en' : 'es';
    applyTranslations();
    updatePlaceholders();
    btn.textContent = currentLang === 'es' ? 'ES | EN' : 'EN | ES';
    renderBlogPosts(); // Re-render blog with new language
  });
  applyTranslations();
}

function applyTranslations() {
  document.querySelectorAll('[data-i18n]').forEach(el => {
    const key = el.getAttribute('data-i18n');
    if (i18n[currentLang][key]) {
      el.textContent = i18n[currentLang][key];
    }
  });
}

function updatePlaceholders() {
  document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
    const key = el.getAttribute('data-i18n-placeholder');
    if (i18n[currentLang][key]) {
      el.placeholder = i18n[currentLang][key];
    }
  });
}

// Services functionality
function initServices() {
  document.querySelectorAll('.service-card').forEach(card => {
    card.addEventListener('click', () => {
      // Close other cards
      document.querySelectorAll('.service-card').forEach(otherCard => {
        if (otherCard !== card) {
          otherCard.classList.remove('active');
        }
      });
      
      card.classList.toggle('active');
      const infoBox = card.querySelector('.service-more');
      const id = card.dataset.service;
      
      if (card.classList.contains('active')) {
        infoBox.innerHTML = currentLang === 'es' ? 
          (id === '1' ? 
            '• Diagnóstico completo de capacidades de exportación<br>• Análisis de mercados objetivo y competencia<br>• Plan de acción 360º con KPIs específicos<br>• Seguimiento y optimización continua' : 
           id === '2' ? 
            '• Investigación profunda de mercados target<br>• Benchmark de precios, canales y competencia<br>• Identificación de partners y distribuidores<br>• Estrategia de entrada paso a paso' : 
           id === '3' ?
            '• Implementación de dashboards de IA para forecasting<br>• Automatización de documentación aduanera<br>• Optimización de rutas logísticas<br>• Análisis predictivo de demanda' :
            '• Estudios de viabilidad económica detallados<br>• Análisis de regulaciones y barreras de entrada<br>• Mapeo de oportunidades por segmento<br>• Recomendaciones estratégicas específicas'
          ) : 
          (id === '1' ? 
            '• Complete export capabilities assessment<br>• Target market and competition analysis<br>• 360º action plan with specific KPIs<br>• Continuous monitoring and optimization' : 
           id === '2' ? 
            '• In-depth target market research<br>• Pricing, channel and competition benchmark<br>• Partner and distributor identification<br>• Step-by-step market entry strategy' : 
           id === '3' ?
            '• AI dashboard implementation for forecasting<br>• Customs documentation automation<br>• Logistics route optimization<br>• Predictive demand analysis' :
            '• Detailed economic feasibility studies<br>• Regulatory and entry barrier analysis<br>• Opportunity mapping by segment<br>• Specific strategic recommendations'
          );
      } else {
        infoBox.innerHTML = '';
      }
    });
  });
}

// Blog functionality - MODIFICADO para usar traducciones
function renderBlogPosts() {
  const blogGrid = document.getElementById('blog-grid');
  if (!blogGrid) return;
  
  blogGrid.innerHTML = '';
  
  blogPosts.forEach((post, index) => {
    const postElement = document.createElement('article');
    postElement.className = 'blog-post';
    
    // Obtener textos traducidos usando las claves
    const title = i18n[currentLang][post.titleKey] || post.titleKey;
    const excerpt = i18n[currentLang][post.excerptKey] || post.excerptKey;
    
    postElement.innerHTML = `
      <div class="post-date">${post.date}</div>
      <h3 class="post-title">${title}</h3>
      <p class="post-excerpt">${excerpt}</p>
      <button class="btn btn--sm btn--outline read-more-btn" data-post="${index}">
        ${currentLang === 'es' ? 'Leer más' : 'Read more'}
      </button>
    `;
    blogGrid.appendChild(postElement);
  });
  
  // Re-initialize modal functionality for new buttons
  const readMoreBtns = document.querySelectorAll('.read-more-btn');
  const postModal = document.getElementById('post-modal');
  const modalClose = document.getElementById('modal-close');
  const modalOverlay = document.querySelector('.modal-overlay');
  const modalTitle = document.getElementById('modal-title');
  const modalDate = document.getElementById('modal-date');
  const modalText = document.getElementById('modal-text');
  
  initBlogModal(readMoreBtns, postModal, modalClose, modalOverlay, modalTitle, modalDate, modalText);
}

// Initialize app
document.addEventListener('DOMContentLoaded', function() {
  console.log('DOM loaded, initializing app...');
  initializeApp();
  initLangToggle();
  initServices();
  renderBlogPosts();
});

function initializeApp() {
  // Get DOM elements
  const navToggle = document.getElementById('nav-toggle');
  const navMenu = document.getElementById('nav-menu');
  const navLinks = document.querySelectorAll('.nav-link');
  const navbar = document.getElementById('navbar');
  const contactForm = document.getElementById('contact-form');

  console.log('Elements found:', {
    navToggle: !!navToggle,
    navMenu: !!navMenu,
    navLinks: navLinks.length,
    contactForm: !!contactForm
  });

  // Initialize all functionality
  initNavigation(navToggle, navMenu, navLinks, navbar);
  initContactForm(contactForm);
  initScrollEffects(navbar, navLinks);
}

// Navigation functionality
function initNavigation(navToggle, navMenu, navLinks, navbar) {
  if (!navToggle || !navMenu || !navLinks.length) {
    console.error('Navigation elements not found');
    return;
  }

  // Mobile menu toggle
  navToggle.addEventListener('click', function() {
    console.log('Nav toggle clicked');
    navToggle.classList.toggle('active');
    navMenu.classList.toggle('active');
  });

  // Navigation links with smooth scrolling
  navLinks.forEach(link => {
    link.addEventListener('click', function(e) {
      e.preventDefault();
      console.log('Nav link clicked:', this.getAttribute('href'));
      const targetId = this.getAttribute('href');
      const targetSection = document.querySelector(targetId);
      
      if (targetSection) {
        const headerHeight = navbar ? navbar.offsetHeight : 80;
        const targetPosition = targetSection.offsetTop - headerHeight;
        console.log('Scrolling to:', targetPosition);
        
        window.scrollTo({
          top: targetPosition,
          behavior: 'smooth'
        });

        // Close mobile menu
        if (navToggle && navMenu) {
          navToggle.classList.remove('active');
          navMenu.classList.remove('active');
        }
      } else {
        console.error('Target section not found:', targetId);
      }
    });
  });
}

// Blog modal functionality
function initBlogModal(readMoreBtns, postModal, modalClose, modalOverlay, modalTitle, modalDate, modalText) {
  if (!readMoreBtns.length || !postModal) {
    console.error('Modal elements not found');
    return;
  }

  console.log('Initializing blog modal with', readMoreBtns.length, 'buttons');

  // Add event listeners to read more buttons
  readMoreBtns.forEach((btn, index) => {
    btn.addEventListener('click', function(e) {
      e.preventDefault();
      console.log('Read more clicked for post', index);
      const postIndex = parseInt(this.getAttribute('data-post')) || index;
      showBlogPost(postIndex, postModal, modalTitle, modalDate, modalText);
    });
  });

  // Close modal events
  if (modalClose) {
    modalClose.addEventListener('click', function() {
      console.log('Modal close clicked');
      closeBlogModal(postModal);
    });
  }

  if (modalOverlay) {
    modalOverlay.addEventListener('click', function() {
      console.log('Modal overlay clicked');
      closeBlogModal(postModal);
    });
  }

  // Close modal with escape key
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape' && !postModal.classList.contains('hidden')) {
      console.log('Escape key pressed');
      closeBlogModal(postModal);
    }
  });
}

// Show blog post in modal - MODIFICADO para usar traducciones
function showBlogPost(index, postModal, modalTitle, modalDate, modalText) {
  console.log('Showing blog post:', index);
  const post = blogPosts[index];
  
  if (post && modalTitle && modalDate && modalText) {
    // Usar traducciones para el modal
    const title = i18n[currentLang][post.titleKey] || post.titleKey;
    const content = i18n[currentLang][post.contentKey] || post.contentKey;
    
    modalTitle.textContent = title;
    modalDate.textContent = post.date;
    modalText.textContent = content;

    // Show modal
    postModal.classList.remove('hidden');
    document.body.style.overflow = 'hidden';
    console.log('Modal shown for post:', title);
  } else {
    console.error('Post not found or modal elements missing:', index);
  }
}

// Close blog modal
function closeBlogModal(postModal) {
  if (postModal) {
    postModal.classList.add('hidden');
    document.body.style.overflow = '';
    console.log('Modal closed');
  }
}

// Contact form functionality
function initContactForm(contactForm) {
  if (!contactForm) {
    console.error('Contact form not found');
    return;
  }

  console.log('Initializing contact form');

  contactForm.addEventListener('submit', function(e) {
    e.preventDefault();
    console.log('Contact form submitted');

    // Get form data
    const formData = new FormData(this);
    const name = formData.get('name') || '';
    const email = formData.get('email') || '';
    const company = formData.get('company') || '';
    const message = formData.get('message') || '';

    console.log('Form data:', { name, email, company, message });

    // Validate required fields
    if (!name.trim() || !email.trim() || !message.trim()) {
      alert(currentLang === 'es' ? 
        'Por favor, completa todos los campos obligatorios.' :
        'Please complete all required fields.');
      return;
    }

    // Create mailto link
    const subject = encodeURIComponent(
      currentLang === 'es' ?
        `Contacto desde web - ${name}${company ? ` (${company})` : ''}` :
        `Website contact - ${name}${company ? ` (${company})` : ''}`
    );
    
    const body = encodeURIComponent(
      currentLang === 'es' ?
        `Hola Òscar,\n\n` +
        `Mi nombre es ${name}${company ? ` y trabajo en ${company}` : ''}.\n\n` +
        `${message}\n\n` +
        `Puedes contactarme en: ${email}\n\n` +
        `Saludos cordiales,\n${name}` :
        `Hello Òscar,\n\n` +
        `My name is ${name}${company ? ` and I work at ${company}` : ''}.\n\n` +
        `${message}\n\n` +
        `You can contact me at: ${email}\n\n` +
        `Best regards,\n${name}`
    );

    const mailtoLink = `mailto:oscarplamartin@hotmail.com?subject=${subject}&body=${body}`;

    console.log('Opening mailto link');

    // Try to open default email client
    try {
      window.location.href = mailtoLink;
      showContactConfirmation();
      this.reset();
    } catch (error) {
      console.error('Error opening email client:', error);
      alert(currentLang === 'es' ?
        'Se ha copiado el email al portapapeles: oscarplamartin@hotmail.com' :
        'Email copied to clipboard: oscarplamartin@hotmail.com');
    }
  });
}

// Scroll effects
function initScrollEffects(navbar, navLinks) {
  if (!navbar) {
    console.error('Navbar not found for scroll effects');
    return;
  }

  let ticking = false;

  function updateScrollEffects() {
    updateNavbarStyle(navbar);
    updateActiveNavLink(navLinks, navbar);
    ticking = false;
  }

  window.addEventListener('scroll', function() {
    if (!ticking) {
      requestAnimationFrame(updateScrollEffects);
      ticking = true;
    }
  });
}

// Update navbar style on scroll
function updateNavbarStyle(navbar) {
  if (navbar) {
    if (window.scrollY > 50) {
      navbar.classList.add('scrolled');
    } else {
      navbar.classList.remove('scrolled');
    }
  }
}

// Update active navigation link based on scroll position
function updateActiveNavLink(navLinks, navbar) {
  if (!navLinks || !navbar) return;

  const sections = document.querySelectorAll('section[id]');
  const scrollPos = window.scrollY + navbar.offsetHeight + 100;

  sections.forEach(section => {
    const top = section.offsetTop;
    const bottom = top + section.offsetHeight;
    const id = section.getAttribute('id');
    const correspondingLink = document.querySelector(`.nav-link[href="#${id}"]`);

    if (scrollPos >= top && scrollPos <= bottom) {
      // Remove active class from all links
      navLinks.forEach(link => link.classList.remove('active'));
      // Add active class to current link
      if (correspondingLink) {
        correspondingLink.classList.add('active');
      }
    }
  });
}

// Show contact confirmation
function showContactConfirmation() {
  // Create temporary notification
  const notification = document.createElement('div');
  notification.className = 'contact-notification';
  notification.style.cssText = `
    position: fixed;
    top: 20px;
    right: 20px;
    background: var(--color-primary);
    color: white;
    padding: 16px 20px;
    border-radius: 8px;
    z-index: 1000;
    max-width: 300px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  `;
  
  notification.innerHTML = currentLang === 'es' ?
    'Se ha abierto tu cliente de correo. Si no se abre automáticamente, contacta en: oscarplamartin@hotmail.com' :
    'Your email client has opened. If it doesn\'t open automatically, contact: oscarplamartin@hotmail.com';

  document.body.appendChild(notification);

  // Remove notification after 5 seconds
  setTimeout(() => {
    if (notification.parentNode) {
      notification.parentNode.removeChild(notification);
    }
  }, 5000);
}
